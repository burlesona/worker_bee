// Generated by CoffeeScript 1.4.0
(function() {
  var root;

  require(['jquery', 'controller', 'views', 'ui', 'login', 'user'], function($) {
    return jQuery(function() {
      return Hive.start();
    });
  });

  root = typeof exports !== "undefined" && exports !== null ? exports : this;

  root.Hive = {
    data: {},
    start: function() {
      var loginHandler, userHandler;
      console.log("START!");
      if (localStorage['api_key'] != null) {
        console.log("CONTINUE!");
        $.ajaxSetup({
          dataType: 'JSON',
          headers: {
            'X-Zen-ApiKey': localStorage['api_key']
          }
        });
        userHandler = new Hive.UserHandler;
        return Hive.Controller.setView('main', '', function() {
          return userHandler.render();
        });
      } else {
        console.log("PROMPT!");
        loginHandler = new Hive.LoginHandler;
        return loginHandler.render();
      }
    },
    login: function(key, user) {
      console.log("LOGIN!");
      localStorage['api_key'] = key;
      Hive.data.user = user;
      return Hive.start();
    },
    logout: function() {
      console.log("LOGOUT!");
      localStorage.removeItem('api_key');
      this.data = {};
      return Hive.start();
    },
    resource: function(name) {
      return "https://agilezen.com/api/v1/" + name;
    }
  };

}).call(this);
